<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8">
  <title>Tryggtbesök Inköpslista</title>
  <style>
    body {
      max-width: 600px;
      margin: 1em auto;
      font-family: sans-serif;
      line-height: 1.4;
    }
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: #000;
      color: #fff;
      padding: 8px;
      z-index: 100;
    }
    .skip-link:focus {
      top: 0;
    }
    h1, h2 {
      margin-top: 1em;
      margin-bottom: 0.5em;
    }
    section + section {
      border-top: 1px solid #ccc;
      padding-top: 1em;
    }
    label {
      display: block;
      padding: 0.75em;
      font-size: 1.4em;
      cursor: pointer;
    }
    input[type="checkbox"] {
      width: 2em;
      height: 2em;
      vertical-align: middle;
      margin-right: 0.75em;
      accent-color: #28a745;
    }
    label:focus-within {
      outline: 3px solid #000;
      outline-offset: 2px;
    }
    /* Nytt: enkel input för att lägga till varor */
    .add-item {
      margin: 1em 0;
      display: flex;
      gap: 0.5em;
    }
    .add-item input {
      flex: 1;
      font-size: 1em;
      padding: 0.5em;
    }
    .add-item button {
      font-size: 1em;
      padding: 0.5em 1em;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <a href="#main" class="skip-link">Hoppa till innehåll</a>
  <main id="main" role="main">
    <h1>Inköpslista</h1>

    <!-- Lägga till varor-delen -->
    <div class="add-item">
      <input type="text" id="new-item-text" placeholder="Lägg till vara…">
      <button id="add-item-btn">Lägg till</button>
    </div>

    <section data-category="fruit">
      <h2>Frukt &amp; Grönt</h2>
      <ul>
        <li><label><input type="checkbox" data-key="fruit_apple">Äpple</label></li>
        <li><label><input type="checkbox" data-key="fruit_banana">Banan</label></li>
        <li><label><input type="checkbox" data-key="fruit_tomat">Tomat</label></li>
        <li><label><input type="checkbox" data-key="fruit_sallad">Sallad</label></li>
      </ul>
    </section>

    <section data-category="bread">
      <h2>Bröd &amp; Bageri</h2>
      <ul>
        <li><label><input type="checkbox" data-key="bread_brod">Bröd</label></li>
        <li><label><input type="checkbox" data-key="bread_frallor">Frallor</label></li>
      </ul>
    </section>

    <section data-category="dairy">
      <h2>Mejeri &amp; Ägg</h2>
      <ul>
        <li><label><input type="checkbox" data-key="dairy_mjolk">Mjölk</label></li>
        <li><label><input type="checkbox" data-key="dairy_kvarg">Kvarg</label></li>
        <li><label><input type="checkbox" data-key="dairy_yoghurt">Yoghurt</label></li>
        <li><label><input type="checkbox" data-key="dairy_agg">Ägg</label></li>
      </ul>
    </section>

    <!-- … övriga sektioner utan varor för att hålla koden kort … -->

  </main>

  <script>
    // Lagra och återställ checkbox-status
    document.querySelectorAll('input[type=checkbox]').forEach(cb => {
      const key = cb.dataset.key;
      cb.checked = localStorage.getItem(key) === 'true';
      cb.addEventListener('change', () => {
        localStorage.setItem(key, cb.checked);
      });
    });

    // Hantera dynamisk tilläggning av nya varor
    document.getElementById('add-item-btn').addEventListener('click', () => {
      const text = document.getElementById('new-item-text').value.trim();
      if (!text) return;
      // Lägg varan under "Övrigt"
      const section = document.querySelector('section[data-category="other"] ul');
      if (!section) {
        alert('Övrigt-sektionen finns inte!');
        return;
      }
      const key = 'other_' + text.toLowerCase().replace(/\s+/g, '_');
      const li = document.createElement('li');
      const label = document.createElement('label');
      const cb = document.createElement('input');
      cb.type = 'checkbox';
      cb.dataset.key = key;
      cb.checked = false;
      // Spara initialt false
      localStorage.setItem(key, 'false');
      // Samma händelsehantering
      cb.addEventListener('change', () => localStorage.setItem(key, cb.checked));
      label.appendChild(cb);
      label.append(text);
      li.appendChild(label);
      section.appendChild(li);
      document.getElementById('new-item-text').value = '';
    });
  </script>
</body>
</html>
